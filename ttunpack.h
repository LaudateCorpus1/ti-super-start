/******************************************************************************
*
* project name:    TIGCC Tools Suite
* file name:       ttunpack.h
* initial date:    01/02/2001
* author:          thomas.nussbaumer@gmx.net
*
* description:     defines for exepack functionalities including unpack routine
*                  (complete rewrite of TIGCC Tools Suite header file)
*
* $Id: ttunpack.h,v 1.4 2002/03/28 21:17:28 tnussb Exp $
*
******************************************************************************/
#ifndef __TTUNPACK_H__
#define __TTUNPACK_H__

typedef struct {
    unsigned char  osize_lo;   // original size lowbyte
    unsigned char  osize_hi;   // original size highbyte
    unsigned char  magic1;     // must be equal to TTUNPACK_MAGIC1
    unsigned char  magic2;     // must be equal to TTUNPACK_MAGIC2
    unsigned char  csize_lo;   // compressed size lowbyte
    unsigned char  csize_hi;   // compressed size lowbyte
    unsigned char  esc1;       // escape >> (8-escBits)
    unsigned char  notused3;
    unsigned char  notused4;
    unsigned char  esc2;       // escBits
    unsigned char  gamma1;     // maxGamma + 1
    unsigned char  gamma2;     // (1<<maxGamma)
    unsigned char  extralz;    // extraLZPosBits
    unsigned char  notused1;
    unsigned char  notused2;
    unsigned char  rleentries; // rleUsed
} TTUNPACK_HEADER;

#define TTUNPACK_MAGIC1 0x54
#define TTUNPACK_MAGIC2 0x50

#define ttunpack_size(_p_)  ((unsigned short)(((TTUNPACK_HEADER*)(_p_))->osize_lo | (((TTUNPACK_HEADER*)(_p_))->osize_hi << 8)))
#define ttunpack_valid(_p_) (((TTUNPACK_HEADER*)(_p_))->magic1 == TTUNPACK_MAGIC1 && ((TTUNPACK_HEADER*)(_p_))->magic2 == TTUNPACK_MAGIC2)

#define TTUNPACK_OKAY             0
#define TTUNPACK_NOESCFOUND     248
#define TTUNPACK_ESCBITS        249
#define TTUNPACK_MAXGAMMA       250
#define TTUNPACK_EXTRALZP       251
#define TTUNPACK_NOMAGIC        252
#define TTUNPACK_OUTBUFOVERRUN  253
#define TTUNPACK_LZPOSUNDERRUN  254

#define GREG_UNPACK_HEXARRAY

#define ttunpack_decompress ((unsigned short(*)(unsigned char*,unsigned char*))(unsigned short[])\
{\
0x206f,0x0004,0x226f,0x0008,0x48e7,0x010c,0x303c,0x0200,0x4e41,0x3f00,\
0x6100,0x0010,0x3200,0x301f,0x4e41,0x3001,0x4cdf,0x3080,0x4e75,0x4e56,\
0xfff4,0x48e7,0x1e30,0x2a09,0x0c28,0x0054,0x0002,0x6708,0x303c,0x00fc,\
0x6000,0x021e,0x0c28,0x0050,0x0003,0x66f0,0x0c28,0x0008,0x000a,0x6708,\
0x303c,0x00fa,0x6000,0x0206,0x0c28,0xff80,0x000b,0x66f0,0x4240,0x1028,\
0x0009,0x3d40,0xfff8,0x303c,0x00f9,0x0c6e,0x0008,0xfff8,0x6200,0x01e6,\
0x4240,0x1028,0x000c,0x3d40,0xfff6,0x303c,0x00fb,0x0c6e,0x0004,0xfff6,\
0x6200,0x01ce,0x4240,0x1028,0x0006,0x3640,0x7008,0x906e,0xfff8,0x3d40,\
0xfffa,0x43e8,0x000f,0x2d49,0xfffc,0x4fef,0xfefc,0x2a4f,0x327c,0x0001,\
0x4217,0x4202,0x1002,0x4880,0x7201,0xe169,0x6f0c,0x3001,0x1b82,0x9000,\
0x5249,0x5340,0x66f6,0x5202,0x0c02,0x0007,0x6fe2,0x7000,0x1028,0x000f,\
0x49f0,0x0810,0x3e3c,0x0080,0x4a6e,0xfff8,0x6600,0x0162,0x380b,0xb84b,\
0x6718,0x302e,0xfffa,0xe16c,0x2445,0x5285,0x3200,0x41fa,0x01c6,0x4e90,\
0x8800,0x1484,0x60da,0x426e,0xfff4,0x45fa,0x016a,0x4e92,0x3c00,0x0c40,\
0x0001,0x6600,0x00e2,0x4240,0x1014,0xc047,0x6700,0x00a4,0xe21f,0x6402,\
0x528c,0x4240,0x1014,0xc047,0x676a,0xe21f,0x6402,0x528c,0x4e92,0x3800,\
0x0c40,0x007f,0x6240,0x4e92,0x0c40,0x001f,0x6224,0x0280,0x0000,0xffff,\
0x206e,0xfffc,0x1030,0x0800,0x0240,0x00ff,0x4242,0x2245,0x5285,0x12c0,\
0x5242,0xb842,0x64f4,0x6000,0xff74,0x3600,0x0643,0xffe0,0xe74b,0x7203,\
0x41fa,0x0148,0x4e90,0x8043,0x60da,0x0644,0xff80,0xe34c,0x7201,0x41fa,\
0x0136,0x4e90,0x8840,0x4e92,0x5340,0xe148,0x8840,0x60a6,0xe21f,0x6402,\
0x528c,0x47fa,0x011e,0x322e,0xfff8,0x4e93,0x3600,0x302e,0xfffa,0xe16c,\
0x2445,0x5285,0x3200,0x4e93,0x8800,0x1484,0x3643,0x6000,0xff1c,0xe21f,\
0x6402,0x528c,0x41fa,0x0094,0x4e90,0x3200,0x0a41,0x00ff,0x4242,0x7000,\
0x3001,0x2045,0x91c0,0x102e,0xfff5,0xd028,0xffff,0x2245,0x5285,0x12c0,\
0x5242,0xbc42,0x64e4,0x6000,0xfee8,0x4e92,0x3600,0x5343,0x0c43,0x00fe,\
0x672a,0x4a6e,0xfff6,0x6612,0x41fa,0x0054,0x4e90,0x3200,0x0a41,0x00ff,\
0xe14b,0x8243,0x60ba,0x302e,0xfff6,0xe16b,0x3200,0x41fa,0x009a,0x4e90,\
0x8640,0x60dc,0x0c46,0x0003,0x630e,0x45fa,0x002a,0x4e92,0x3d40,0xfff4,\
0x4e92,0x608e,0x4240,0x6010,0x322e,0xfff8,0x41fa,0x0074,0x4e90,0x3800,\
0x6000,0xfe94,0x4cee,0x0c78,0xffdc,0x4e5e,0x4e75,0x101c,0xe148,0x1014,\
0x1235,0x7000,0x5201,0xe268,0x0240,0x00ff,0x4e75,0x3407,0x1014,0xc400,\
0x673c,0xd402,0x5302,0x1235,0x7000,0xc002,0xb102,0x6608,0x142c,0x0001,\
0x4602,0x5001,0x9235,0x2000,0x1401,0x5202,0x0c01,0x0007,0x6504,0x7207,\
0x7407,0x3007,0xe43f,0xbe00,0x6502,0x528c,0x6100,0x0010,0x5201,0x03c0,\
0x4e75,0x7001,0xe21f,0x6526,0x4e75,0x7000,0x5301,0x6520,0x6732,0x3007,\
0xe23f,0xbe00,0x6518,0xd040,0x5340,0xc01c,0xe148,0x1014,0x1435,0x7800,\
0xe468,0xe21f,0x6402,0x528c,0x4e75,0xd040,0x5340,0xc014,0x1435,0x7800,\
0xe428,0xe21f,0x65ec,0x4e75,0x1014,0xc007,0x56c0,0x0200,0x0001,0xe21f,\
0x65dc,0x4e75})

#endif

//=============================================================================
// Revision History
//=============================================================================
//
// $Log: ttunpack.h,v $
// Revision 1.4  2002/03/28 21:17:28  tnussb
// project name in header changed to TIGCC Tools Suite
//
// Revision 1.3  2002/03/13 15:09:58  tnussb
// new exepack decompression function generated from old/unpack.c added
// (its a little bit smaller now). The new function should work as the old one,
// but if there are problems I will leave the old hexcode array here, too
//
// Revision 1.2  2001/02/05 20:33:01  Thomas Nussbaumer
// (1) magic of ttunpack header splitted again into 2 bytes to prevent address errors
// (2) new (stable?) pc-relative version of unpacking routine
//
//


 